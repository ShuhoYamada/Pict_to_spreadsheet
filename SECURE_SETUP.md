# 🔒 セキュア写真ファイル管理システム 使用手順

## ⚡ クイックスタート

### 1. 依存関係のインストール
```bash
cd "/Users/nagai/Downloads/研究関係/05_システム"
npm install
```

### 2. 環境変数の設定
`.env`ファイルを編集して、Google Cloud Consoleで取得した値を設定：
```bash
GOOGLE_API_KEY=あなたの実際のAPIキー
GOOGLE_CLIENT_ID=あなたの実際のクライアントID
```

### 3. サーバー起動
```bash
npm start
```

### 4. アクセス
ブラウザで `http://localhost:3000` にアクセス

## 🛡️ セキュリティ機能

### ✅ 実装されたセキュリティ対策

1. **APIキーの完全隠蔽**
   - APIキーはサーバーサイドの環境変数に保存
   - フロントエンドに一切露出されない

2. **バックエンド経由のAPI通信**
   - すべてのGoogle APIs呼び出しはサーバー経由
   - クライアントから直接APIを叩かない

3. **Git管理の安全性**
   - `.gitignore`で機密ファイルを除外
   - 誤ってAPIキーをコミットするリスクを回避

4. **セッション管理**
   - ブラウザのセッションストレージで認証状態管理
   - 1時間でタイムアウト

### 🚫 セキュリティリスクを回避

- ❌ APIキーをJavaScriptファイルに直接記述
- ❌ フロントエンドから直接Google APIsを呼び出し
- ❌ 機密情報をGitリポジトリにコミット

## 📋 使用手順

1. **認証**
   - 「セキュアな認証が必要です」ボタンをクリック
   - Google認証ページに自動リダイレクト
   - 権限を許可してサービスに戻る

2. **フォルダ選択**
   - 「フォルダを選択」ボタンをクリック
   - Googleドライブのフォルダ一覧から選択

3. **スプレッドシート選択**
   - 「スプレッドシートを選択」ボタンをクリック
   - 書き込み先スプレッドシートを選択

4. **データ処理**
   - 「データを処理してスプレッドシートに書き込む」をクリック
   - セキュアな処理結果を確認

## 🔧 開発者向け設定

### Google Cloud Console設定
1. プロジェクト作成：`photo-file-manager`
2. API有効化：Google Drive API, Google Sheets API
3. 認証情報作成：
   - APIキー（サーバーIP制限推奨）
   - OAuth 2.0クライアントID
   - 承認済みリダイレクトURI：`http://localhost:3000/auth/callback`

### 本番環境での追加セキュリティ
- HTTPS必須
- CORS設定の厳格化
- レート制限の実装
- ログ監視の設定

## 🚨 重要な注意事項

1. **`.env`ファイルは絶対に公開しない**
2. **本番環境ではHTTPS使用必須**
3. **定期的にAPIキーをローテーション**
4. **不要な権限は要求しない**

このセキュアな実装により、APIキー漏洩のリスクを完全に排除し、安全にGoogle APIsを利用できます。